package dev.akif.malwarenotifications.http.dto;

import dev.akif.malwarenotifications.TestData;
import lombok.val;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertEquals;

public class DetectionDTOTest {
    @Test
    @DisplayName("DetectionDTO can be created from a Detection")
    void testCreateFromDetection() {
        val detection = TestData.facebook;
        val dto = new DetectionDTO(detection);

        assertEquals(detection.id(), dto.id());
        assertEquals(detection.time(), dto.time());
        assertEquals(detection.type(), dto.type());
        assertEquals(detection.appName(), dto.appName());
        assertEquals(detection.appType(), dto.appType());
    }

    @Test
    @DisplayName("DetectionDTO can be converted to a Detection, given a device")
    void testConvertToDetection() {
        val id = TestData.facebook.id();
        val time = TestData.facebook.time();
        val type = TestData.facebook.type();
        val appName = TestData.facebook.appName();
        val appType = TestData.facebook.appType();

        val dto = new DetectionDTO(id, time, type, appName, appType);

        assertEquals(TestData.facebook, dto.toDetection(TestData.iPhone));
    }
}
