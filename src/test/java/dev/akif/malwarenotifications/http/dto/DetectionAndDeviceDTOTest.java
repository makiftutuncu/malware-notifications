package dev.akif.malwarenotifications.http.dto;

import dev.akif.malwarenotifications.TestData;
import lombok.val;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertEquals;

public class DetectionAndDeviceDTOTest {
    @Test
    @DisplayName("DetectionAndDeviceDTO can be created from a Detection")
    void testCreateFromDetection() {
        val device = TestData.iPhone;
        val detection = TestData.facebook;
        val dto = new DetectionAndDeviceDTO(detection);

        assertEquals(detection.id(), dto.detection().id());
        assertEquals(detection.time(), dto.detection().time());
        assertEquals(detection.type(), dto.detection().type());
        assertEquals(detection.appName(), dto.detection().appName());
        assertEquals(detection.appType(), dto.detection().appType());
        assertEquals(device.id(), dto.device().id());
        assertEquals(device.type(), dto.device().type());
        assertEquals(device.model(), dto.device().model());
        assertEquals(device.os(), dto.device().os());
    }
}
