package dev.akif.malwarenotifications.persistence.detection;

import dev.akif.malwarenotifications.TestData;
import lombok.val;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertEquals;

public class DetectionEntityTest {
    @Test
    @DisplayName("DetectionEntity can be created from a Detection")
    void testCreateFromDetection() {
        val id = TestData.facebook.id();
        val time = TestData.facebook.time();
        val type = TestData.facebook.type();
        val appName = TestData.facebook.appName();
        val appType = TestData.facebook.appType();

        val entity = new DetectionEntity(TestData.facebook);

        assertEquals(id, entity.getId());
        assertEquals(TestData.iPhoneEntity(), entity.getDevice());
        assertEquals(time, entity.getTime());
        assertEquals(type, entity.getType());
        assertEquals(appName, entity.getAppName());
        assertEquals(appType, entity.getAppType());
    }

    @Test
    @DisplayName("DetectionEntity can be converted to a Detection")
    void testConvertToDetection() {
        val id = TestData.facebook.id();
        val time = TestData.facebook.time();
        val type = TestData.facebook.type();
        val appName = TestData.facebook.appName();
        val appType = TestData.facebook.appType();

        val entity = new DetectionEntity(id, TestData.iPhoneEntity(), time, type, appName, appType);
        val detection = entity.toDetection();

        assertEquals(TestData.facebook, entity.toDetection());
    }
}
