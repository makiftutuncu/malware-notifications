package dev.akif.malwarenotifications.persistence.detection;

import dev.akif.malwarenotifications.detection.DetectionType;
import lombok.NonNull;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;
import org.springframework.data.repository.PagingAndSortingRepository;

import java.util.List;
import java.util.Set;
import java.util.UUID;

public interface DetectionCrudRepository extends DetectionRepository, PagingAndSortingRepository<DetectionEntity, UUID> {
    @NonNull Page<DetectionEntity> findAllByTypeIn(@NonNull Pageable pageable, @NonNull Set<DetectionType> detectionTypes);

    List<DetectionEntity> findAllByDeviceIdOrderByTimeDescAppNameAsc(@NonNull UUID deviceId);

    @Override
    @NonNull
    default Page<DetectionEntity> findAll(@NonNull Pageable pageable, @NonNull Set<DetectionType> detectionTypes) {
        return findAllByTypeIn(pageable, detectionTypes);
    }

    @Override
    @NonNull
    default List<DetectionEntity> findByDeviceId(@NonNull UUID deviceId) {
        return findAllByDeviceIdOrderByTimeDescAppNameAsc(deviceId);
    }

    @Override
    default void createOrUpdateAll(@NonNull List<DetectionEntity> detectionEntities) {
        saveAll(detectionEntities);
    }
}
