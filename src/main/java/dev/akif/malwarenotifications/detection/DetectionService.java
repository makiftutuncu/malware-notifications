package dev.akif.malwarenotifications.detection;

import dev.akif.malwarenotifications.device.Device;
import lombok.NonNull;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;

import java.time.Instant;
import java.util.List;
import java.util.Set;

/**
 * A service for managing malware detections.
 */
public interface DetectionService {
    /**
     * Lists previously stored malware detections for given page and {@link DetectionType}s.
     *
     * @param pageable       Page of detections to return.
     * @param detectionTypes Types of detections to return.
     * @return Page of detections.
     */
    @NonNull Page<Detection> listDetections(@NonNull Pageable pageable, @NonNull Set<DetectionType> detectionTypes);

    /**
     * Processes a new malware scan that was run on given {@link Device} at given time resulting in given {@link Detection}s.
     *
     * @param device     Device that was scanned
     * @param time       Time of the scan
     * @param detections Detections that were found
     */
    void processMalwareScan(@NonNull Device device,
                            @NonNull Instant time,
                            @NonNull List<Detection> detections);
}
