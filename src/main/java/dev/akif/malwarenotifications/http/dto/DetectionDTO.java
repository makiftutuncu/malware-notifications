package dev.akif.malwarenotifications.http.dto;

import dev.akif.malwarenotifications.detection.Detection;
import dev.akif.malwarenotifications.detection.DetectionType;
import dev.akif.malwarenotifications.device.Device;
import lombok.NonNull;

import java.time.Instant;
import java.util.UUID;

/**
 * A DTO for a malware detection.
 *
 * @param id      id of the detection
 * @param time    time of the detection
 * @param type    type of the detection
 * @param appName name of the application that was detected
 * @param appType type of the application that was detected
 */
public record DetectionDTO(@NonNull UUID id,
                           @NonNull Instant time,
                           @NonNull DetectionType type,
                           String appName,
                           String appType) {
    /**
     * Constructs a new {@link DetectionDTO} from given {@link Detection}.
     *
     * @param detection Detection from which to construct the DTO
     */
    public DetectionDTO(@NonNull Detection detection) {
        this(
                detection.id(),
                detection.time(),
                detection.type(),
                detection.appName(),
                detection.appType()
        );
    }

    /**
     * Converts this DTO to a {@link Detection}.
     *
     * @return Converted detection model
     */
    public @NonNull Detection toDetection(@NonNull Device device) {
        return new Detection(
                id,
                device,
                time,
                type,
                appName,
                appType
        );
    }
}
