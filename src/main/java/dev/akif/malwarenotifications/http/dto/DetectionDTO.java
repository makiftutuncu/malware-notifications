package dev.akif.malwarenotifications.http.dto;

import dev.akif.malwarenotifications.detection.Detection;
import dev.akif.malwarenotifications.detection.DetectionType;
import dev.akif.malwarenotifications.device.Device;
import lombok.NonNull;

import java.time.Instant;
import java.util.UUID;

public record DetectionDTO(@NonNull UUID id,
                           @NonNull Instant time,
                           @NonNull DetectionType type,
                           String appName,
                           String appType) {
    public DetectionDTO(@NonNull Detection detection) {
        this(
                detection.id(),
                detection.time(),
                detection.type(),
                detection.appName(),
                detection.appType()
        );
    }

    public @NonNull Detection toDetection(@NonNull Device device) {
        return new Detection(
                id,
                device,
                time,
                type,
                appName,
                appType
        );
    }
}
